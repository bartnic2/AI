{"id":"635dc9cd-eed2-4174-8697-3cc7cc761d6a","revision":0,"last_node_id":66,"last_link_id":73,"nodes":[{"id":46,"type":"WanVideoTextEmbedBridge","pos":[1204.152587890625,707.1484985351562],"size":[315,46],"flags":{},"order":20,"mode":2,"inputs":[{"localized_name":"positive","name":"positive","type":"CONDITIONING","link":54},{"localized_name":"negative","name":"negative","type":"CONDITIONING","link":55}],"outputs":[{"localized_name":"text_embeds","name":"text_embeds","type":"WANVIDEOTEXTEMBEDS","links":null}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"e5fbe79872a1f6fbe48751dd30a16124df7dd71a","Node name for S&R":"WanVideoTextEmbedBridge"},"widgets_values":[]},{"id":50,"type":"CLIPTextEncode","pos":[754.153076171875,967.1485595703125],"size":[400,200],"flags":{},"order":16,"mode":2,"inputs":[{"localized_name":"clip","name":"clip","type":"CLIP","link":53}],"outputs":[{"localized_name":"CONDITIONING","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[55]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.26","Node name for S&R":"CLIPTextEncode"},"widgets_values":["色调艳丽，过曝，静态，细节模糊不清，字幕，风格，作品，画作，画面，静止，整体发灰，最差质量，低质量，JPEG压缩残留，丑陋的，残缺的，多余的手指，画得不好的手部，画得不好的脸部，畸形的，毁容的，形态畸形的肢体，手指融合，静止不动的画面，杂乱的背景，三条腿，背景人很多，倒着走"]},{"id":48,"type":"CLIPLoader","pos":[394.15313720703125,717.1484985351562],"size":[315,98.00003051757812],"flags":{},"order":0,"mode":2,"inputs":[],"outputs":[{"localized_name":"CLIP","name":"CLIP","type":"CLIP","slot_index":0,"links":[52,53]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.26","Node name for S&R":"CLIPLoader"},"widgets_values":["umt5_xxl_fp16.safetensors","wan","default"]},{"id":49,"type":"CLIPTextEncode","pos":[754.153076171875,717.1484985351562],"size":[400,200],"flags":{},"order":15,"mode":2,"inputs":[{"localized_name":"clip","name":"clip","type":"CLIP","link":52}],"outputs":[{"localized_name":"CONDITIONING","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[54]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.26","Node name for S&R":"CLIPTextEncode"},"widgets_values":["high quality nature video featuring a red panda balancing on a bamboo stem while a bird lands on it's head, on the background there is a waterfall"]},{"id":42,"type":"Note","pos":[-580,-760],"size":[314.96246337890625,152.77333068847656],"flags":{},"order":1,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Adjust the blocks to swap based on your VRAM, this is a tradeoff between speed and memory usage.\n\nAlternatively there's option to use VRAM management introduced in DiffSynt-Studios. This is usually slower, but saves even more VRAM compared to BlockSwap"],"color":"#432","bgcolor":"#653"},{"id":45,"type":"WanVideoVRAMManagement","pos":[-210,-580],"size":[315,58],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[{"localized_name":"vram_management_args","name":"vram_management_args","type":"VRAM_MANAGEMENTARGS","links":[]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"e5fbe79872a1f6fbe48751dd30a16124df7dd71a","Node name for S&R":"WanVideoVRAMManagement"},"widgets_values":[1],"color":"#223","bgcolor":"#335"},{"id":51,"type":"Note","pos":[424.153076171875,547.1480712890625],"size":[253.16725158691406,88],"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["You can also use native ComfyUI text encoding with these nodes instead of the original, the models are node specific and can't otherwise be mixed."],"color":"#432","bgcolor":"#653"},{"id":54,"type":"Note","pos":[961.6879272460938,-580.803466796875],"size":[327.61932373046875,88],"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Enhance-a-video can increase the fidelity of the results, too high values lead to noisy results."],"color":"#432","bgcolor":"#653"},{"id":53,"type":"Note","pos":[960.3718872070312,-810.77099609375],"size":[324.64129638671875,159.47401428222656],"flags":{},"order":5,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["TeaCache could be considered to be sort of an automated step skipper \n\nThe relative l1 threshold -value determines how aggressive this is, higher values are faster but quality suffers more. Very first steps should NEVER be skipped with this model or it kills the motion. When using the pre-calculated coefficients, the treshold value should be much higher than with the default coefficients."],"color":"#432","bgcolor":"#653"},{"id":38,"type":"WanVideoVAELoader","pos":[169.25408935546875,-322.9471740722656],"size":[372.7727966308594,82],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[{"localized_name":"vae","name":"vae","type":"WANVAE","slot_index":0,"links":[43,63]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"e5fbe79872a1f6fbe48751dd30a16124df7dd71a","Node name for S&R":"WanVideoVAELoader"},"widgets_values":["Wan2_1_VAE_bf16.safetensors","bf16"],"color":"#322","bgcolor":"#533"},{"id":11,"type":"LoadWanVideoT5TextEncoder","pos":[161.7229461669922,-501.2225036621094],"size":[377.1661376953125,130],"flags":{},"order":8,"mode":0,"inputs":[],"outputs":[{"localized_name":"wan_t5_model","name":"wan_t5_model","type":"WANTEXTENCODER","slot_index":0,"links":[15]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"e5fbe79872a1f6fbe48751dd30a16124df7dd71a","Node name for S&R":"LoadWanVideoT5TextEncoder"},"widgets_values":["umt5-xxl-enc-bf16.safetensors","bf16","offload_device","disabled"],"color":"#332922","bgcolor":"#593930"},{"id":52,"type":"WanVideoTeaCache","pos":[1307.6705322265625,-787.4303588867188],"size":[315,178],"flags":{},"order":9,"mode":0,"inputs":[],"outputs":[{"localized_name":"teacache_args","name":"teacache_args","type":"TEACACHEARGS","links":[69]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"e5fbe79872a1f6fbe48751dd30a16124df7dd71a","Node name for S&R":"WanVideoTeaCache"},"widgets_values":[0.20000000000000004,6,-1,"offload_device","true","e"]},{"id":39,"type":"WanVideoBlockSwap","pos":[-210,-760],"size":[315,154],"flags":{},"order":10,"mode":0,"inputs":[],"outputs":[{"localized_name":"block_swap_args","name":"block_swap_args","type":"BLOCKSWAPARGS","slot_index":0,"links":[50]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"e5fbe79872a1f6fbe48751dd30a16124df7dd71a","Node name for S&R":"WanVideoBlockSwap"},"widgets_values":[28,false,false,true,0],"color":"#223","bgcolor":"#335"},{"id":28,"type":"WanVideoDecode","pos":[1688.0194091796875,-647.6461791992188],"size":[315,174],"flags":{},"order":22,"mode":0,"inputs":[{"localized_name":"vae","name":"vae","type":"WANVAE","link":43},{"localized_name":"samples","name":"samples","type":"LATENT","link":70}],"outputs":[{"localized_name":"images","name":"images","type":"IMAGE","slot_index":0,"links":[36]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"e5fbe79872a1f6fbe48751dd30a16124df7dd71a","Node name for S&R":"WanVideoDecode"},"widgets_values":[false,272,272,144,128],"color":"#322","bgcolor":"#533"},{"id":55,"type":"WanVideoEnhanceAVideo","pos":[1304.073486328125,-566.0877075195312],"size":[315,106],"flags":{},"order":11,"mode":0,"inputs":[],"outputs":[{"localized_name":"feta_args","name":"feta_args","type":"FETAARGS","links":[68]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"e5fbe79872a1f6fbe48751dd30a16124df7dd71a","Node name for S&R":"WanVideoEnhanceAVideo"},"widgets_values":[1.9500000000000004,0,1]},{"id":63,"type":"WanVideoSampler","pos":[1315.2401123046875,-401.48028564453125],"size":[333.0633850097656,548.9950561523438],"flags":{},"order":21,"mode":0,"inputs":[{"localized_name":"model","name":"model","type":"WANVIDEOMODEL","link":65},{"localized_name":"text_embeds","name":"text_embeds","type":"WANVIDEOTEXTEMBEDS","link":66},{"localized_name":"image_embeds","name":"image_embeds","type":"WANVIDIMAGE_EMBEDS","link":67},{"localized_name":"samples","name":"samples","shape":7,"type":"LATENT","link":null},{"localized_name":"feta_args","name":"feta_args","shape":7,"type":"FETAARGS","link":68},{"localized_name":"context_options","name":"context_options","shape":7,"type":"WANVIDCONTEXT","link":null},{"localized_name":"teacache_args","name":"teacache_args","shape":7,"type":"TEACACHEARGS","link":69},{"localized_name":"flowedit_args","name":"flowedit_args","shape":7,"type":"FLOWEDITARGS","link":null},{"localized_name":"slg_args","name":"slg_args","shape":7,"type":"SLGARGS","link":null},{"localized_name":"loop_args","name":"loop_args","shape":7,"type":"LOOPARGS","link":null},{"localized_name":"experimental_args","name":"experimental_args","shape":7,"type":"EXPERIMENTALARGS","link":null}],"outputs":[{"localized_name":"samples","name":"samples","type":"LATENT","links":[70]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"e5fbe79872a1f6fbe48751dd30a16124df7dd71a","Node name for S&R":"WanVideoSampler"},"widgets_values":[24,6.000000000000001,4.000000000000001,841995542971853,"fixed",true,"unipc",0,1,false,"default"]},{"id":22,"type":"WanVideoModelLoader","pos":[150,-780],"size":[477.4410095214844,226.43276977539062],"flags":{},"order":18,"mode":0,"inputs":[{"localized_name":"compile_args","name":"compile_args","shape":7,"type":"WANCOMPILEARGS","link":null},{"localized_name":"block_swap_args","name":"block_swap_args","shape":7,"type":"BLOCKSWAPARGS","link":50},{"localized_name":"lora","name":"lora","shape":7,"type":"WANVIDLORA","link":null},{"localized_name":"vram_management_args","name":"vram_management_args","shape":7,"type":"VRAM_MANAGEMENTARGS","link":null}],"outputs":[{"localized_name":"model","name":"model","type":"WANVIDEOMODEL","slot_index":0,"links":[65]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"e5fbe79872a1f6fbe48751dd30a16124df7dd71a","Node name for S&R":"WanVideoModelLoader"},"widgets_values":["wan2.1_i2v_720p_14B_bf16.safetensors","bf16","fp8_e4m3fn","offload_device","sdpa"],"color":"#223","bgcolor":"#335"},{"id":16,"type":"WanVideoTextEncode","pos":[612.5955810546875,-100.47425079345703],"size":[643.6239013671875,323.2996826171875],"flags":{},"order":17,"mode":0,"inputs":[{"localized_name":"t5","name":"t5","type":"WANTEXTENCODER","link":15},{"localized_name":"model_to_offload","name":"model_to_offload","shape":7,"type":"WANVIDEOMODEL","link":null}],"outputs":[{"localized_name":"text_embeds","name":"text_embeds","type":"WANVIDEOTEXTEMBEDS","slot_index":0,"links":[66]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"e5fbe79872a1f6fbe48751dd30a16124df7dd71a","Node name for S&R":"WanVideoTextEncode"},"widgets_values":["Wide shot: A dimly lit street in a foggy, old town. The camera slowly pans across the cobblestone road, revealing vintage buildings with warm light spilling from the windows. Gentle rain falls, creating reflections on the wet pavement, enhancing the moody atmosphere, suddenly the ground floor of the building explodes, sending fire, smoke and debris out through all the windows onto the street,","cartoon, 3d, cgi, jpg, compression, distortion, morphing, low-res, fake, ",true],"color":"#332922","bgcolor":"#593930"},{"id":57,"type":"WanVideoImageClipEncode","pos":[703.9295043945312,-420.3932189941406],"size":[319.20001220703125,266],"flags":{},"order":19,"mode":0,"inputs":[{"localized_name":"clip_vision","name":"clip_vision","type":"CLIP_VISION","link":58},{"localized_name":"image","name":"image","type":"IMAGE","link":59},{"localized_name":"vae","name":"vae","type":"WANVAE","link":63}],"outputs":[{"localized_name":"image_embeds","name":"image_embeds","type":"WANVIDIMAGE_EMBEDS","slot_index":0,"links":[67]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"e5fbe79872a1f6fbe48751dd30a16124df7dd71a","Node name for S&R":"WanVideoImageClipEncode"},"widgets_values":[1184,640,89,true,0.05000000000000001,1.0000000000000002,1,true],"color":"#2a363b","bgcolor":"#3f5159"},{"id":36,"type":"Note","pos":[146.6604766845703,-1016.2440185546875],"size":[374.3061828613281,171.9547576904297],"flags":{},"order":13,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["fp8_fast seems to cause huge quality degradation\n\nfp_16_fast enables \"Full FP16 Accmumulation in FP16 GEMMs\" feature available in the very latest pytorch nightly, this is around 20% speed boost. \n\nSageattn if you have it installed can be used for almost double inference speed"],"color":"#432","bgcolor":"#653"},{"id":33,"type":"Note","pos":[151.412841796875,-1160.7386474609375],"size":[359.0753479003906,88],"flags":{},"order":14,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["Models:\nhttps://huggingface.co/Kijai/WanVideo_comfy/tree/main"],"color":"#432","bgcolor":"#653"},{"id":56,"type":"LoadWanVideoClipTextEncoder","pos":[-508.78729248046875,-163.9664306640625],"size":[510.6601257324219,106],"flags":{},"order":7,"mode":0,"inputs":[],"outputs":[{"localized_name":"wan_clip_vision","name":"wan_clip_vision","type":"CLIP_VISION","slot_index":0,"links":[58]}],"properties":{"cnr_id":"ComfyUI-WanVideoWrapper","ver":"e5fbe79872a1f6fbe48751dd30a16124df7dd71a","Node name for S&R":"LoadWanVideoClipTextEncoder"},"widgets_values":["open-clip-xlm-roberta-large-vit-huge-14_visual_fp16.safetensors","fp16","offload_device"],"color":"#2a363b","bgcolor":"#3f5159"},{"id":58,"type":"LoadImage","pos":[95.3826675415039,-152.15672302246094],"size":[413.10479736328125,498.3180847167969],"flags":{},"order":12,"mode":0,"inputs":[],"outputs":[{"localized_name":"IMAGE","name":"IMAGE","type":"IMAGE","links":[59]},{"localized_name":"MASK","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.26","Node name for S&R":"LoadImage"},"widgets_values":["00000-1277990566.png","image",""],"color":"#2a363b","bgcolor":"#3f5159"},{"id":30,"type":"VHS_VideoCombine","pos":[2081.2294921875,-706.552734375],"size":[1245.8460693359375,334],"flags":{},"order":23,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":36},{"localized_name":"audio","name":"audio","shape":7,"type":"AUDIO","link":null},{"localized_name":"meta_batch","name":"meta_batch","shape":7,"type":"VHS_BatchManager","link":null},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":null}],"outputs":[{"localized_name":"Filenames","name":"Filenames","type":"VHS_FILENAMES","links":null}],"properties":{"cnr_id":"comfyui-videohelpersuite","ver":"0a75c7958fe320efcb052f1d9f8451fd20c730a8","Node name for S&R":"VHS_VideoCombine"},"widgets_values":{"frame_rate":15,"loop_count":0,"filename_prefix":"720p","format":"video/h264-mp4","pix_fmt":"yuv420p","crf":18,"save_metadata":true,"trim_to_audio":false,"pingpong":false,"save_output":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"720p_00107.mp4","subfolder":"","type":"output","format":"video/h264-mp4","frame_rate":15,"workflow":"720p_00107.png","fullpath":"D:\\SD MATRIX\\Data\\Packages\\ComfyUI\\output\\720p_00107.mp4"}}}}],"links":[[15,11,0,16,0,"WANTEXTENCODER"],[36,28,0,30,0,"IMAGE"],[43,38,0,28,0,"VAE"],[50,39,0,22,1,"BLOCKSWAPARGS"],[52,48,0,49,0,"CLIP"],[53,48,0,50,0,"CLIP"],[54,49,0,46,0,"CONDITIONING"],[55,50,0,46,1,"CONDITIONING"],[58,56,0,57,0,"CLIP_VISION"],[59,58,0,57,1,"IMAGE"],[63,38,0,57,2,"WANVAE"],[65,22,0,63,0,"WANVIDEOMODEL"],[66,16,0,63,1,"WANVIDEOTEXTEMBEDS"],[67,57,0,63,2,"WANVIDIMAGE_EMBEDS"],[68,55,0,63,4,"FETAARGS"],[69,52,0,63,6,"TEACACHEARGS"],[70,63,0,28,1,"LATENT"]],"groups":[{"id":1,"title":"ComfyUI text encoding alternative","bounding":[331.337158203125,403.2147216796875,1210.621337890625,805.9080810546875],"color":"#3f789e","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":0.7247295000000005,"offset":[-383.598393967341,1017.3039336948594]},"node_versions":{"ComfyUI-WanVideoWrapper":"721cd65e7b5224c70a3d20446d9d561f1732216b","comfy-core":"0.3.19","ComfyUI-VideoHelperSuite":"2c25b8b53835aaeb63f831b3137c705cf9f85dce"},"VHS_latentpreview":false,"VHS_latentpreviewrate":0,"VHS_MetadataImage":true,"VHS_KeepIntermediate":true,"ue_links":[]},"version":0.4}